<section id="projects">
    <h2>Proyectos Destacados</h2>
    <p>Selección de algunos proyectos y trabajos webs y móviles recientes</p>

    <div class="toogle">
        <div class="item">
            <input
                type="radio"
                class="toogle-item"
                id="todo"
                name="selected"
                checked
            />
            <label for="todo">Todo</label>
        </div>
        <div class="item">
            <input type="radio" class="toogle-item" id="web" name="selected" />
            <label for="web"><i class="fa-solid fa-globe"></i> Web</label>
        </div>
        <div class="item">
            <input
                type="radio"
                class="toogle-item"
                id="mobile"
                name="selected"
            />
            <label for="mobile"><i class="fa-solid fa-mobile"></i> Mobile</label
            >
        </div>
    </div>

    <div class="container-project"></div>
</section>

<script type="module">
    document.addEventListener("DOMContentLoaded", () => {
        const webSelected = document.getElementById("web");
        const mobileSelected = document.getElementById("mobile");
        const todoSelected = document.getElementById("todo");
        const container = document.querySelector(".container-project");

        fetch("/json/projects.json")
            .then((res) => res.json())
            .then((data) => {
                function renderProject(projects) {
                    container.innerHTML = "";

                    if (projects.length === 0) {
                        container.innerHTML =
                            "<p>Ups... Aún no hay proyectos en esta categoría</p>";
                        return;
                    }

                    projects.forEach((p) => {
                        const card = document.createElement("div");
                        card.className = "proyecto-card";

                        const link = document.createElement("a");
                        link.href = p.enlace;
                        link.target = "_blank";

                        link.innerHTML = `
              <div class="tipe-project"><span>${p.tipo}</span></div>
              <div class="project-image">
                <img src='${p.img}' alt='${p.nombre}' />
              </div>
              <div class="project-info">
                <h3>${p.nombre}</h3>
                <p>${p.descripcion}</p>
              </div>
              <div class="tecnologias-projecto">
                ${p.tecnologias.map((t) => `<div class="tecno-proj">${t}</div>`).join("")}
              </div>
            `;

                        card.appendChild(link);
                        container.appendChild(card);
                    });
                }

                renderProject(data); // Mostrar todos por defecto

                todoSelected?.addEventListener("change", () =>
                    renderProject(data),
                );
                webSelected?.addEventListener("change", () => {
                    const filtered = data.filter((p) => p.tipo === "web");
                    renderProject(filtered);
                });
                mobileSelected?.addEventListener("change", () => {
                    const filtered = data.filter((p) => p.tipo === "movil");
                    renderProject(filtered);
                });
            })
            .catch((err) => {
                console.error("Error al cargar los proyectos:", err);
                container.innerHTML = "<p>Error al cargar los proyectos</p>";
            });
    });
</script>

<style>
    h2 {
        text-align: center;
    }

    p {
        text-align: center;
        color: #ccc;
    }

    .toogle-item {
        position: absolute;
        opacity: 0;
        pointer-events: none;
    }

    .toogle {
        margin: 5rem auto 0 auto;
        border: 1px solid #ccc;
        width: max-content;
        border-radius: 1rem;
        display: flex;
        padding: 0.5rem 0rem;
        justify-content: center;
        align-items: center;
    }

    .toogle label {
        padding: 0.5rem 1rem;
        border-radius: 1rem;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .toogle-item:checked + label {
        background-color: #33ccff;
        color: white;
        border-color: #33ccff;
    }

    .container-project {
        display: flex;
        justify-content: center;
        align-items: center;
        flex-wrap: wrap;
        gap: 1rem;
        margin: 2rem;
        padding: 3rem;
    }
</style>
<style is:global>
    .proyecto-card {
        overflow: hidden;
        position: relative;
        border: 1px solid #9a9a9a;
        border-radius: 30px;
        padding: 2rem;
        height: 27rem;
        width: 17rem;
        background-color: #1a1a1a;
        transition:
            transform 0.3s ease,
            box-shadow 0.3s ease;
    }

    .proyecto-card:hover {
        transform: scale(1.03);
        box-shadow: 0 0 10px #33ccff55;
    }

    .proyecto-card a {
        color: #fafafa;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        width: 100%;
        height: 100%;
        text-decoration: none;
    }

    .project-image img {
        width: 100%;
        border-radius: 1rem;
        object-fit: cover;
        height: 100%;
    }

    .project-info h3 {
        margin: 1rem 0 0.5rem 0;
    }

    .project-info p {
        font-size: 0.9rem;
        color: #aaa;
    }

    .tecnologias-projecto {
        display: flex;
        flex-wrap: wrap;
        gap: 0.3rem;
        margin-top: 1rem;
    }

    .tecno-proj {
        background-color: #333;
        padding: 0.3rem 0.7rem;
        border-radius: 1rem;
        font-size: 0.75rem;
        color: #fff;
    }

    .tipe-project span {
        background-color: #1b4654;
        color: #fff;
        padding: 0.2rem 0.6rem;
        border-radius: 0.5rem;
        font-size: 0.7rem;
        text-transform: uppercase;
        font-weight: bold;
    }
</style>
